#include "panel.h"
#include "heart.h"
extern void initmap(int (*map)[MAP_ROW],int color){
	int i,j;
	int m=0,n=0;			//m,n用来记录当前访问的数组元素的下标
	//清空数组
	for(m=0;m<MAP_LINE;m++)
		for(n=0;n<MAP_ROW;n++)
			map[m][n]=0;
	m=0;n=0;

	//	两边空格数			*号的数量			中间空格数		两边是对称的
	int num_spc_side	=	12,num_aster		=10,num_spc_mid		=15;
	int num_spc_side_count=	0,num_aster_count	=0,num_spc_mid_count	=0;
	//	*号数量变化的步长，4->3
	int num_aster_step	=	4,num_spc_mid_step	=2;
	int top_part_line=7,top_part_count=0;

	//绘制心型上面部分
	for(;top_part_count <top_part_line;)
	{
		for(	num_spc_side_count=0;num_spc_side_count < num_spc_side;
			num_spc_side_count++)
			{
			map[m][n]=0;
			n+=1;
			}
		
		for(num_aster_count=0;num_aster_count < num_aster;
			num_aster_count++)
			{
			map[m][n]=color;				//指定颜色
			n+=1;
			}
		
		for(	num_spc_mid_count=0;num_spc_mid_count < num_spc_mid;
			num_spc_mid_count++)
			{
			map[m][n]=0;
			n+=1;
			}

		for(num_aster_count=0;num_aster_count < num_aster;
			num_aster_count++)
			{
			map[m][n]=color;				//指定颜色
			n+=1;
			}
		
		for(	num_spc_side_count=0;num_spc_side_count < num_spc_side;
			num_spc_side_count++)
			{
			map[m][n]=0;
			n+=1;
			}

		//对下一次要输出的空格和*的数量进行调整
		top_part_count++;
		num_spc_side	=	12-2*top_part_count;
		num_aster	=	top_part_count*3+10;
		num_spc_mid	=	15-top_part_count*2;
		n		 =	0;		//本行输出结束 n置0，m+1	
		m		+=	1;
	}
  
  
	for(i=0;i<6;i++)//显示中间6排
	{
  		for(j=0;j<MAP_ROW-1;j++)
  			{
				map[m][n]=color;
				n+=1;
			}
	m+=1;
	n =0;
	}
  
	for(i=0;i<14;i++)//显示呈递减趋势规律的中间14排
	{
		
  		for(j=0;j<2*(i+1)-1;j++)
  			{
			map[m][n]=0;
			n+=1;
			}
  		for(j=0;j<57-i*4;j++)
  			{
			map[m][n]=color;
			n+=1;
			}
		for(j=0;j<2*(i+1)-1;j++)
  			{
			map[m][n]=0;
			n+=1;
			}
		m+=1;
		n =0;
  	
	}
  
	for(i=0;i<29;i++,n++)//最后一个星号*与上面的规律脱节了  所以独立显示
		{map[m][n]=0;}
	map[m][n]=color;n=n+1;
	for(i=0;i<18;i++,n++)//补上后面的空格
		{map[m][n]=0;
		}
}

extern void initmapbyhand(int (*map)[MAP_ROW],int color){

//瑞文手画的心
int array_hand[30][60]={
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,},
{0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,},
{0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,0,0,0,0,0,0,0,1,1,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
{1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
{0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,0,},
{0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,},
{0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,},
{0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,}};
	int i,j;
	for(i=0;i<MAP_LINE;i++)
		for(j=0;j<MAP_ROW;j++)
		{
			if(array_hand[i][j]==1)
				map[i][j]=color;		//非空的地方设为颜色值
			else if(array_hand[i][j]==2)
				map[i][j]=RANDOM;
				else
					map[i][j]=0;
		}

}
extern void addto(int (*arr)[MAP_ROW],int line ,int row){
	int i=0,j=0;
	int m=line,n=row;
	for(;i<MAP_LINE;i++,m++)
		for(j=0,n=row;j<MAP_ROW;j++,n++){
			if(panel[m][n] == 0)
			panel[m][n] = arr[i][j];
			else if(arr[i][j]!=0 && panel[m][n]!=0)				//如果当前要复制的是无色的点，则以前的颜色标识为重叠区
				panel[m][n]=panel[m][n]*100;        //以前的值乘100用来标识重叠部分
				
				
		}
}

//矩阵缩放函数
extern int matrix_varys(int (*arr)[MAP_ROW],int w)
{
	int temp[MAP_LINE][MAP_ROW];
	int m,n;
	for(m=0;m<MAP_LINE;m++)		//保存以前的数组并清空
		for(n=0;n<MAP_ROW;n++)
			{
			temp[m][n]=arr[m][n];
			arr[m][n]=0;
		}

//必要变量申明
	int a=w;			//传递引入的参数	
	int x_final,y_final;		//最终画心的坐标
	int Space_x=0,Space_y=0;	//心型位置偏移量
	Space_x=(15-a)*1;
	Space_y=(15-a)*2;
	int x1,y1,x2,y2;		//在心型变化时必要的形参
	
	int x=0,y=0;
	x=a*2;				//新心型的高
	y=a*4;				//新心型的宽





//将原矩阵按比例缩放并存储于新矩阵(核心部分)
	for(x1=0;x1<x;x1++)
	   for(y1=0;y1<y;y1++)
		{x2=(int)(30*x1/x+0.5);
		 y2=(int)(60*y1/y+0.5);
		 x_final=x1+Space_x;
		 y_final=y1+Space_y;
		 arr[x_final][y_final]=temp[x2][y2];};




}


//矩阵缩放函数
extern int matrix_by_stand(int (*temp)[MAP_ROW],int (*arr)[MAP_ROW],int w)
{
	int i,j;
	for(i=0;i<MAP_LINE;i++)
		for(j=0;j<MAP_ROW;j++)
			temp[i][j]=0;
//必要变量申明
	int a=w;			//传递引入的参数	
	int x_final,y_final;		//最终画心的坐标
	int Space_x=0,Space_y=0;	//心型位置偏移量
	Space_x=(15-a)*1;
	Space_y=(15-a)*2;
	int x1,y1,x2,y2;		//在心型变化时必要的形参
	
	int x=0,y=0;
	x=a*2;				//新心型的高
	y=a*4;				//新心型的宽





//将原矩阵按比例缩放并存储于新矩阵(核心部分)
	for(x1=0;x1<x;x1++)
	   for(y1=0;y1<y;y1++)
		{x2=(int)(30*x1/x+0.5);
		 y2=(int)(60*y1/y+0.5);
		 x_final=x1+Space_x;
		 y_final=y1+Space_y;
		 temp[x_final][y_final]=arr[x2][y2];};




}
